!function(a){a.fn.sequence=function(b,c,d){"boolean"!=typeof d&&(d=!0);var e=!1,f=0,g=this,h=a.Deferred(),i={},j={paused:!d,interval:c},k=null,l=0,m=0,n=function(){delete i.promise,h=a.Deferred(),f=0,e=!1,k=null,l=0,m=0,i.promise=h,i.reset=function(){i.hold(),n()},i.getInterval=function(){return j.interval},i.setInterval=function(a){e||(j.interval=a)},i.hold=function(){e||(m=1-(Date.now()-l)/j.interval,clearTimeout(k),j.paused=!0)},i.release=function(a){e||("undefined"==typeof a&&(a="now"),j.paused=!1,p(a))},i.runAll=function(){if(!e){i.hold();for(var d,c=f;d=g.get(c);)b.apply(d),a(d).data("sequence-done",!0),c++;o(!0)}},i.clear=function(){e||(i.hold(),o(!1))}};n();var o=function(a){"boolean"!=typeof a&&(a=!0),g.removeData("sequence-queued").removeData("sequence-done"),console.log("clean up in here"),a?h.resolve(i):h.reject(i),e=!0},p=function(c){if(!j.paused){"undefined"==typeof c&&(c="now");var d=j.interval;switch(c){case"remaining":d*=m;break;case"now":var e=g.get(f);if("undefined"==typeof e)return;if(b.apply(e),a(e).data("sequence-done",!0),f++,f===g.length)return void o(!0)}l=Date.now(),k=setTimeout(function(){p()},d)}};return d&&setTimeout(function(){p()}),i}}(jQuery);